<Window x:Class="SearchMate.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings" Height="500" Width="340" WindowStartupLocation="CenterOwner" ResizeMode="NoResize" WindowStyle="None" AllowsTransparency="True" Background="{DynamicResource WindowBackgroundBrush}">
    <Window.Resources>
        <DropShadowEffect x:Key="DropShadowEffect" BlurRadius="12" ShadowDepth="2" Opacity="0.10"/>
        <Style x:Key="FlatButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
                    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ErrorTextBoxStyle" TargetType="TextBox">
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Style.Triggers>
                <Trigger Property="Tag" Value="error">
                    <Setter Property="BorderBrush" Value="#E53935"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ComboBoxItemStyle" TargetType="ComboBoxItem">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Padding" Value="8,2"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" SnapsToDevicePixels="true">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
        </Style>
    </Window.Resources>
    <Border CornerRadius="16" Background="{DynamicResource WindowBackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Padding="0" Effect="{DynamicResource DropShadowEffect}">
        <Grid Margin="18">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <TextBlock Text="Settings" FontSize="20" FontWeight="Bold" Margin="0 0 0 20" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>

            <StackPanel Grid.Row="1" Orientation="Vertical" Margin="0 0 0 12">
                <TextBlock Text="Max Search Result" FontSize="13" FontWeight="Medium" Margin="0 0 0 4" Foreground="{DynamicResource PrimaryTextBrush}"/>
                <ComboBox x:Name="MaxSearchResultCombo" Height="28" FontSize="13" Margin="0 0 0 4" SelectedIndex="0" Padding="8,0" Foreground="#222" Style="{StaticResource ComboBoxStyle}" ItemContainerStyle="{StaticResource ComboBoxItemStyle}">
                    <ComboBoxItem Content="500"/>
                    <ComboBoxItem Content="1000"/>
                    <ComboBoxItem Content="2000"/>
                    <ComboBoxItem Content="5000"/>
                </ComboBox>
                <Border Background="{DynamicResource WarningBackgroundBrush}" CornerRadius="6" Padding="8" Margin="0 2 0 0">
                    <TextBlock Text="Increasing max result may slow down the search process." FontSize="11" Foreground="{DynamicResource WarningTextBrush}"/>
                </Border>
            </StackPanel>

            <StackPanel Grid.Row="2" Orientation="Vertical" Margin="0 0 0 0">
                <CheckBox x:Name="EnableCacheBox" Content="Enable cache" FontSize="13" Margin="0 0 0 8" Checked="EnableCacheBox_Checked" Unchecked="EnableCacheBox_Unchecked" Foreground="{DynamicResource PrimaryTextBrush}"/>
                <StackPanel Orientation="Vertical" Margin="16 0 0 0">
                    <TextBlock Text="Max Cache Files" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource PrimaryTextBrush}"/>
                    <TextBox x:Name="MaxCacheFilesBox" Height="28" FontSize="13" Margin="0 6 0 0" Style="{StaticResource ErrorTextBoxStyle}" TextChanged="MaxCacheFilesBox_TextChanged"/>
                    <TextBlock x:Name="MaxCacheFilesError" Foreground="#E53935" FontSize="11" Margin="2 2 0 0" Visibility="Collapsed"/>
                    <CheckBox x:Name="AutoCleanCacheBox" Content="Clean cache automatically" FontSize="12" Margin="0 6 0 6" Checked="AutoCleanCacheBox_Checked" Unchecked="AutoCleanCacheBox_Unchecked" Foreground="{DynamicResource PrimaryTextBrush}"/>
                    <TextBlock Text="Expiration Time (days)" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource PrimaryTextBrush}"/>
                    <TextBox x:Name="ExpirationTimeBox" Height="28" FontSize="13" Margin="0 6 0 0" Style="{StaticResource ErrorTextBoxStyle}" TextChanged="ExpirationTimeBox_TextChanged"/>
                    <TextBlock x:Name="ExpirationTimeError" Foreground="#E53935" FontSize="11" Margin="2 2 0 0" Visibility="Collapsed"/>
                </StackPanel>
            </StackPanel>

            <StackPanel Grid.Row="3" Orientation="Vertical" Margin="0 0 0 0">
                <CheckBox x:Name="DarkThemeBox" Content="Dark Theme" FontSize="13" Margin="0 8 0 8" Foreground="{DynamicResource PrimaryTextBrush}"/>
            </StackPanel>

            <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0 32 0 0">
                <Button Content="Clear all cache" Width="120" Height="28" Margin="0 0 8 0" Click="ClearCache_Click" Style="{StaticResource FlatButtonStyle}"/>
                <Button Content="Cancel" Width="80" Height="28" Margin="0 0 8 0" Click="Cancel_Click" Style="{StaticResource FlatButtonStyle}"/>
                <Button Content="Save" Width="80" Height="28" Click="Save_Click" Style="{StaticResource FlatButtonStyle}"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>
